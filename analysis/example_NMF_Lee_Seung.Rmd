##########################
# Example
##########################
# load input data
#V <- load_image_file(train_images_file)
#V <- V[, 1:10]
#V <- V - min(V) # make it positive!

data <- load_synthetic()
V <- data$V
W <- data$W
H <- data$H

F <- dim(V)[1]
N <- dim(V)[2]
K <- 10 # dimensions of the latent space


# Initializations
##################
# True matrices
initH <- data$H # matrix(1, nrow = K, ncol = N)
initW <- data$W # matrix(1, nrow = F, ncol = K)

# All ones
initH <- matrix(1, nrow = K, ncol = N)
initW <- matrix(1, nrow = F, ncol = K)

# Random (Lee and Seung)
initH <- matrix(runif(K*N), nrow = K, ncol= N)
initW <- matrix(runif(F*K), nrow = F, ncol = K)

# run NMF
#################
res <- nmf_Lee(V, K, initW, initH, maxiters = 1000)
W <- res$W
H <- res$H

# Plot results
#####################
par(mfrow=c(1,4))
image(V)
title('V')
image(W)
title('W')
image(H)
title('H')
image(W%*%H)
title('W*H')
